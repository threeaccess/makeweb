# Make Web

A Python CLI tool that converts Markdown files into styled, responsive HTML pages with theme switching, dark/light mode, auto-generated table of contents, and batch site generation.

## Requirements

- Python 3.8+
- [`markdown`](https://pypi.org/project/markdown/) library

```bash
pip install markdown
```

## Quick Start

```bash
# Convert a single file
python make_web.py notes.md

# Specify output path
python make_web.py notes.md -o docs/notes.html

# Self-contained HTML (all CSS inlined, no external files)
python make_web.py notes.md --standalone

# Batch-convert all .md files in the current directory
python make_web.py --buildsite
```

## Usage

```
make-web [-h] [-o OUTPUT] [--no-toc] [--standalone] [--badge TEXT]
         [--subtitle TEXT] [--index-url URL] [--buildsite] [--force]
         [input]
```

### Single File Mode

| Flag | Description |
|------|-------------|
| `input` | Path to the Markdown file |
| `-o`, `--output` | Output HTML path (default: same name with `.html` extension) |
| `--no-toc` | Disable table of contents |
| `--standalone` | Generate self-contained HTML with all CSS inlined |
| `--badge TEXT` | Header badge text (default: "Documentation") |
| `--subtitle TEXT` | Page subtitle (default: "Generated by Make Web") |
| `--index-url URL` | Add a breadcrumb navigation link back to an index page |

### Batch Mode (`--buildsite`)

| Flag | Description |
|------|-------------|
| `--buildsite` | Scan the current directory recursively for `.md` files, convert them all into an `html/` directory, and generate an `index.html` |
| `--force` | Rebuild all files even if the HTML output is newer than the source |

Batch mode is incremental by default: files are skipped when the HTML output is already up-to-date (mtime check). Orphaned HTML files whose source `.md` has been deleted are detected and listed in a "Deleted Files" section of the index.

### PowerShell Wrapper

A `makeweb.ps1` wrapper is included for convenience on Windows:

```powershell
.\makeweb.ps1 notes.md
.\makeweb.ps1 -buildsite
.\makeweb.ps1 -buildsite -force
```

Set `$env:PYTHON_BIN` to override the Python executable (defaults to `python`).

## Output Structure

### Single File

```
output.html
styles/
  core.css
  content.css
  theme-modern.css
  theme-minimal.css
  ...
```

### Batch (`--buildsite`)

```
index.html              # Searchable site index
html/
  styles/               # Copied CSS files
  file1.html
  subdir/
    file2.html
```

The directory structure of the source `.md` files is mirrored inside `html/`. Each generated page includes a breadcrumb link back to `index.html`.

## Themes

Four built-in themes are included:

| Theme | Description |
|-------|-------------|
| Modern | Default theme with a clean, contemporary look |
| Minimal | Stripped-down, content-focused styling |
| Modal | Card-based layout with elevated UI elements |
| Print | Optimized for printing and PDF export |

All themes support light and dark color schemes. Users can switch themes and color modes via controls in the page header; preferences are saved to `localStorage`.

### Adding a Custom Theme

Create a CSS file named `styles/theme-{name}.css`. It will be auto-discovered at runtime. Themes override CSS custom properties defined in `core.css`, so structural styles never need to be duplicated. For example:

```css
/* styles/theme-ocean.css */
[data-theme-name="ocean"] {
  --color-primary: #0077b6;
  --color-bg: #f0f8ff;
}
[data-theme-name="ocean"][data-color-scheme="dark"] {
  --color-bg: #001a2e;
}
```

An optional `themes.json` at the repo root can customize display names and the default theme:

```json
{
  "default_theme": "ocean",
  "themes": {
    "ocean": { "name": "Ocean Blue" }
  }
}
```

## How It Works

1. **Read** the Markdown source (handles UTF-8, UTF-16, and legacy encodings).
2. **Extract the title** from the first `# heading`.
3. **Convert** Markdown to HTML using the `markdown` library with extensions (extra, tables, fenced_code, sane_lists, toc, codehilite).
4. **Generate** a table of contents from the heading structure.
5. **Retarget** external links to open in a new tab (`target="_blank"`).
6. **Render** the HTML template by substituting variables (`string.Template`).
7. **Write** the output HTML and copy the `styles/` directory alongside it.

## Project Structure

```
make_web.py                              # Main application
makeweb.ps1                              # PowerShell wrapper
templates/
  content_template.html                  # Single-page template
  index_template.html                    # Index page template
  buildsite_index_template.html          # Batch-build index template
styles/
  core.css                               # CSS variables, resets, shared components
  content.css                            # Content page styles
  index.css                              # Index page styles
  theme-modern.css                       # Modern theme
  theme-minimal.css                      # Minimal theme
  theme-modal.css                        # Modal theme
  theme-print.css                        # Print theme
```

## CSS Architecture

Styles are layered:

1. **`core.css`** -- CSS custom properties, resets, dark/light mode, shared UI components
2. **`content.css`** or **`index.css`** -- page-type-specific layout and typography
3. **`theme-*.css`** -- color and style overrides via custom properties

This layering means themes only need to set variables, not redefine structural rules.
